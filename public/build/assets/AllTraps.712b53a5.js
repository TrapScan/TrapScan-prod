import{A as q}from"./AdminLayout.28d54cb0.js";import{S as j,P as Q,t as A,m as S,p as N}from"./pickBy.f2ac900d.js";import{u as T,r as l,o as a,c as f,w as r,a as e,d as i,b as _,f as b,F as g,g as B,h as x,t as u}from"./app.3ce61da7.js";import{_ as L}from"./_plugin-vue_export-helper.cdc0426e.js";import{E as z}from"./index.ee154714.js";const E={name:"AllTraps",props:{filters:Object,qrs:Object,traps:Object},components:{AdminLayout:q,SearchFilter:j,Pagination:Q},data(){return{dialogVisible:!1,form:{search:this.filters.search},newQR:T({nz_id:null,qr_id:null})}},watch:{form:{deep:!0,handler:A(function(){this.$inertia.get(route("admin.unmapped_traps"),N(this.form),{preserveState:!0})},150)}},methods:{reset(){this.form=S(this.form,()=>null)},submit(){this.newQR.post(route("admin.map_trap"),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{z({message:"Congrats, trap mapped.",type:"success"}),this.newQR.qr_id=null,this.newQR.nz_id=null,this.dialogVisible=!1}})},open(d){this.newQR.nz_id=d,this.dialogVisible=!0},print(d){axios({url:route("api.print_code",d),method:"GET",responseType:"blob"}).then(s=>{const n=window.URL.createObjectURL(new Blob([s.data])),c=document.createElement("a");c.href=n,c.setAttribute("download","image.png"),document.body.appendChild(c),c.click()})}}},U={class:"flex items-center justify-between mb-6 mx-8 mt-8"},F={class:"mx-8 bg-white dark:bg-mirage-500 rounded-md shadow overflow-x-auto"},O={class:"w-full whitespace-nowrap"},P=e("tr",{class:"text-left font-bold"},[e("th",{class:"pb-4 pt-6 px-6"},"Project"),e("th",{class:"pb-4 pt-6 px-6"},"Trap Name"),e("th",{class:"pb-4 pt-6 px-6"},"NZ ID"),e("th",{class:"pb-4 pt-6 px-6"},"QR"),e("th",{class:"pb-4 pt-6 px-6 text-center"},"Actions")],-1),D={class:"border-t"},I={class:"flex items-center px-6 py-4 focus:text-indigo-500"},G={class:"border-t"},M={class:"flex items-center px-6 py-4"},Z={class:"border-t"},H={class:"flex items-center px-6 py-4"},J={class:"border-t"},K={class:"flex items-center px-6 py-4"},W={class:"border-t"},X={class:"flex w-full justify-center"},Y=["onClick"],$=["onClick"],ee={key:0},te=e("td",{class:"px-6 py-4 border-t",colspan:"4"},"No found.",-1),se=[te],oe={class:"flex justify-center"},le={class:"dialog-footer"},ne=x("Cancel"),ae=x("Confirm");function re(d,s,n,c,o,p){const w=l("search-filter"),y=l("pagination"),k=l("el-option"),V=l("el-select"),m=l("el-button"),v=l("el-dialog"),C=l("AdminLayout");return a(),f(C,null,{default:r(()=>[e("div",U,[i(w,{modelValue:o.form.search,"onUpdate:modelValue":s[0]||(s[0]=t=>o.form.search=t),class:"mr-4 w-full max-w-md",onReset:p.reset},null,8,["modelValue","onReset"])]),e("div",F,[e("table",O,[P,(a(!0),_(g,null,b(n.traps.data,t=>{var h;return a(),_("tr",{key:t.id,class:"hover:bg-gray-100 dark:hover:bg-mirage-400 focus-within:bg-gray-100"},[e("td",D,[e("span",I,u((h=t.project)==null?void 0:h.name),1)]),e("td",G,[e("span",M,u(t.name),1)]),e("td",Z,[e("span",H,u(t.nz_trap_id),1)]),e("td",J,[e("span",K,u(t.qr_id),1)]),e("td",W,[e("div",X,[e("button",{onClick:R=>p.print(t.qr_id),class:"uppercase p-2 mr-1 rounded-full text-sm text-white font-bold bg-blue-500 hover:bg-blue-800"},"Print trap",8,Y),e("button",{onClick:R=>p.open(t.nz_trap_id),class:"uppercase p-2 rounded-full text-white text-sm font-bold bg-niagara-500 hover:bg-green-800"},"Remap trap",8,$)])])])}),128)),n.traps.data.length===0?(a(),_("tr",ee,se)):B("",!0)])]),i(y,{class:"mt-6",links:n.traps.links},null,8,["links"]),i(v,{modelValue:o.dialogVisible,"onUpdate:modelValue":s[3]||(s[3]=t=>o.dialogVisible=t),title:"Install QR for Trap",width:"20%"},{footer:r(()=>[e("span",le,[i(m,{onClick:s[2]||(s[2]=t=>o.dialogVisible=!1)},{default:r(()=>[ne]),_:1}),i(m,{type:"primary",onClick:p.submit},{default:r(()=>[ae]),_:1},8,["onClick"])])]),default:r(()=>[e("div",oe,[i(V,{modelValue:o.newQR.qr_id,"onUpdate:modelValue":s[1]||(s[1]=t=>o.newQR.qr_id=t),filterable:"",placeholder:"Select",class:"w-full"},{default:r(()=>[(a(!0),_(g,null,b(n.qrs,t=>(a(),f(k,{key:t.qr_code,label:t.qr_code,value:t.qr_code},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1},8,["modelValue"])]),_:1})}const ue=L(E,[["render",re]]);export{ue as default};
//# sourceMappingURL=AllTraps.712b53a5.js.map
