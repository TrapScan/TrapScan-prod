{"version":3,"file":"AllTraps.712b53a5.js","sources":["../../../resources/js/Pages/Admin/AllTraps.vue"],"sourcesContent":["<template>\n    <AdminLayout>\n\n        <div class=\"flex items-center justify-between mb-6 mx-8 mt-8\">\n            <search-filter v-model=\"form.search\" class=\"mr-4 w-full max-w-md\" @reset=\"reset\">\n            </search-filter>\n        </div>\n        <div class=\" mx-8 bg-white dark:bg-mirage-500 rounded-md shadow overflow-x-auto\">\n            <table class=\"w-full whitespace-nowrap\">\n                <tr class=\"text-left font-bold\">\n                    <th class=\"pb-4 pt-6 px-6\">Project</th>\n                    <th class=\"pb-4 pt-6 px-6\">Trap Name</th>\n                    <th class=\"pb-4 pt-6 px-6\">NZ ID</th>\n                    <th class=\"pb-4 pt-6 px-6\">QR</th>\n                    <th class=\"pb-4 pt-6 px-6 text-center\">Actions</th>\n                </tr>\n                <tr v-for=\"trap in traps.data\" :key=\"trap.id\" class=\"hover:bg-gray-100 dark:hover:bg-mirage-400 focus-within:bg-gray-100\">\n                    <td class=\"border-t\">\n                        <span class=\"flex items-center px-6 py-4 focus:text-indigo-500\">\n                            {{trap.project?.name}}\n                        </span>\n                    </td>\n                    <td class=\"border-t\">\n                        <span class=\"flex items-center px-6 py-4\" >\n\n                            {{ trap.name }}\n                        </span>\n                    </td>\n                    <td class=\"border-t\">\n                        <span class=\"flex items-center px-6 py-4\" >\n                            {{ trap.nz_trap_id}}\n                        </span>\n                    </td>\n                    <td class=\"border-t\">\n                        <span class=\"flex items-center px-6 py-4\" >\n                            {{ trap.qr_id}}\n                        </span>\n                    </td>\n                    <td class=\"border-t\">\n                        <div class=\"flex w-full justify-center\">\n                            <button @click=\"print(trap.qr_id)\" class=\"uppercase p-2 mr-1 rounded-full text-sm text-white font-bold bg-blue-500 hover:bg-blue-800\">Print trap</button>\n                            <button @click=\"open(trap.nz_trap_id)\" class=\"uppercase p-2 rounded-full text-white text-sm font-bold bg-niagara-500 hover:bg-green-800\">Remap trap</button>\n\n                        </div>\n                    </td>\n                </tr>\n                <tr v-if=\"traps.data.length === 0\">\n                    <td class=\"px-6 py-4 border-t\" colspan=\"4\">No found.</td>\n                </tr>\n            </table>\n        </div>\n        <pagination class=\"mt-6\" :links=\"traps.links\" />\n\n        <el-dialog\n            v-model=\"dialogVisible\"\n            title=\"Install QR for Trap\"\n            width=\"20%\"\n        >\n            <div class=\"flex justify-center\">\n                <el-select v-model=\"newQR.qr_id\" filterable placeholder=\"Select\" class=\"w-full\">\n                    <el-option\n                        v-for=\"item in qrs\"\n                        :key=\"item.qr_code\"\n                        :label=\"item.qr_code\"\n                        :value=\"item.qr_code\"\n                    />\n                </el-select>\n            </div>\n\n            <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">Cancel</el-button>\n        <el-button type=\"primary\" @click=\"submit\"\n        >Confirm</el-button\n        >\n      </span>\n            </template>\n        </el-dialog>\n\n    </AdminLayout>\n</template>\n\n<script>\nimport AdminLayout from \"@/Layouts/AdminLayout.vue\";\nimport throttle from 'lodash/throttle'\nimport mapValues from 'lodash/mapValues'\nimport SearchFilter from '@/Components/SearchFilter.vue'\nimport Pagination from '@/Components/Pagination.vue'\nimport {useForm} from \"@inertiajs/inertia-vue3\";\nimport pickBy from 'lodash/pickBy'\nimport { ElMessage } from 'element-plus'\n\nexport default {\n    name: \"AllTraps\",\n    props: {\n        filters: Object,\n        qrs: Object,\n        traps: Object,\n    },\n    components: {AdminLayout, SearchFilter, Pagination},\n    data() {\n        return {\n            dialogVisible: false,\n            form: {\n                search: this.filters.search\n            },\n            newQR: useForm({\n                nz_id:null,\n                qr_id:null\n            })\n        }\n    },\n    watch: {\n        form: {\n            deep: true,\n            handler: throttle(function () {\n                this.$inertia.get(route('admin.unmapped_traps'), pickBy(this.form), { preserveState: true })\n            }, 150),\n        },\n    },\n    methods: {\n        reset() {\n            this.form = mapValues(this.form, () => null)\n        },\n        submit() {\n            this.newQR.post(route('admin.map_trap'),{\n                preserveScroll: true,\n                preserveState: true,\n                onSuccess:() => {\n                    ElMessage({\n                        message: 'Congrats, trap mapped.',\n                        type: 'success',\n                    })\n                    this.newQR.qr_id = null;\n                    this.newQR.nz_id = null;\n                    this.dialogVisible = false;\n            }\n            })\n        },\n        open(nz_id){\n            this.newQR.nz_id = nz_id;\n            this.dialogVisible = true;\n        },\n        print (item) {\n            axios({\n                url: route('api.print_code', item),\n                method: 'GET',\n                responseType: 'blob' // important\n            }).then((response) => {\n                const url = window.URL.createObjectURL(new Blob([response.data]))\n                const link = document.createElement('a')\n                link.href = url\n                link.setAttribute('download', 'image.png')\n                document.body.appendChild(link)\n                link.click()\n            })\n        }\n    }\n}\n</script>\n\n<style scoped>\n\n</style>\n"],"names":["pickBy","mapValues","_createElementVNode","_createBlock","_createVNode","_openBlock","_createElementBlock","_Fragment","_renderList","_toDisplayString"],"mappings":"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"}